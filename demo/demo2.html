<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no"/>
<link type="text/css" rel="stylesheet" media="all"
    href="css/demo2.css">

</head>
<body>
	<div id="tip" >
		<p>Please use webkit browser to watch this example.</p>
		<p>If you want to try touch Event please make sure you already turn on developer tool "Emulate touch screen".</p>
		<p>Feel free to submit issue or bug to this project, address is <a href="https://github.com/BE-FE/MSlider">https://github.com/BE-FE/MSlider</a>
	</div>
	<div id="content">
		<div id="outer">
			<div id="canvas">
				<div id="nav">
					<a>Home</a>
					<a class="on">Page1</a>
					<a>Page2</a>
					<a>Page3</a>
				</div>
				<div id="show"> 
					
				</div>
			</div>
		</div>
		<div id="menu">
			<span>isLooping: false</span>
			<span>isVertical: false</span>
			<span>isAutoplay: false</span>
			<span>changeOrientation: 90</span>
		</div>
	</div>
	<script type="text/javascript" src="js/mslider.js"></script>
	<script type="text/javascript">
	var list = [{
		'height' : '100%',
		'width' : '100%',
		'content' : '<div><h1>Home</h1><h2>This is home page</h2><p>home is pretty awsome</p><div>'
	},{
		'height' : '100%',
		'width' : '100%',
		'content' : '<div><h1>Page1</h1><h2>This is page1</h2><p>page1 is pretty awsome</p><div>'
	},{
		'height' : '100%',
		'width' : '100%',
		'content' : '<div><h1>Page2</h1><h2>This is Page2</h2><p>Page2 is pretty awsome</p><div>'
	},{
		'height' : '100%',
		'width' : '100%',
		'content' : '<div><h1>Page3</h1><h2>This is page3</h2><p>page3 is pretty awsome</p><div>'
	}];

	var mslider = new MSlider({
	    data: list,
	    type: 'dom',
	    dom: document.getElementById("show"),
	    duration: 2000,
	   	onslidechange: function(){}
	});


	(function(){
		var menu = document.getElementById('menu');
		var spans = document.getElementsByTagName('span');

		spans[0].onclick = function(){
			var target = spans[0];
			if (target.className == 'on') {
				target.className = '';
				target.innerText = 'isLooping: false';
			} else {
				target.className = 'on';	
				target.innerText = 'isLooping: true';
			}

			mslider._opts.isLooping = !mslider._opts.isLooping 
			mslider.reset();
		}

		spans[1].onclick = function(){
			var target = spans[1];
			if (target.className == 'on') {
				target.className = '';
				target.innerText = 'isVertical: false';
			} else {
				target.className = 'on';	
				target.innerText = 'isVertical: true';
			}

			mslider._opts.isVertical = !mslider._opts.isVertical;
			mslider.reset();
		}

		spans[2].onclick = function(){
			var target = spans[2];
			if (target.className == 'on') {
				target.className = '';
				target.innerText = 'isAutoplay: false';
			} else {
				target.className = 'on';	
				target.innerText = 'isAutoplay: true';
			}

			mslider._opts.isAutoplay = !mslider._opts.isAutoplay;
			mslider.reset();
		}

		spans[3].onclick = function(){
			var target = spans[3];
			var outer = document.getElementById('outer');
			var menu = document.getElementById('menu');
			var canvas = document.getElementById('canvas');
			var content = document.getElementById('content');

			if (target.className == 'on') {
				target.className = '';
				outer.className = '';
				menu.className = '';
				target.innerText = 'changeOrientation: 0';
				canvas.className = '';
				outer.appendChild(canvas);
				setTimeout(function(){
					mslider.reset();
				}, 200);
			} else {
				target.className = 'on';
				outer.className = 'rotated_outer';
				menu.className = 'rotated_menu';
				target.innerText = 'changeOrientation: 90';
				setTimeout(function(){
					content.appendChild(canvas);
					canvas.className = 'rotated_canvas';
					mslider.reset();
				}, 200);
			}
		}

		if (navigator.userAgent.match(/(iPhone\sOS)\s([\d_]+)|(Android)\s+([\d.]+)/)) {
			var menu = document.getElementById('menu');
			var tip = document.getElementById('tip');
			var flag = false;
			var isChild = function (child, parent) {
				var target = child;
		        
		        while (target !== parent && target !== document.body) {
		            target = target.parentNode;
		        }
				
				return target === parent;
			}

			window.addEventListener('touchmove', function (evt) {
				flag = true;
			}, true);

			window.addEventListener('touchend', function (evt) {
				if (!flag) {
					if (isChild(evt.target, tip) || isChild(evt.target, menu)) {
						flag = false;
						return;
					}
					menu.className = menu.className == 'show' ? '' : 'show';
					tip.className = tip.className == 'show' ? '' : 'show';
				}
				flag = false;

				window.scrollTo(0, 1);
			}, true)
			
			menu.className = 'show';
			tip.className = 'show';
			setTimeout(function(){
				menu.className = '';
				tip.className = '';
			}, 3000);
		}
	})();
	</script>
</body>
</html>
